<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=0">
    <title>203Garage｜the vintage store</title>
    <meta name="description" content="203Garage｜Main Page">
    <meta name="keywords" content="vintage, 빈티지샵, 빈티지, 중고매장, 중고 옷 팔기">

    <meta property="og:type" content="website">
    <!--
    <meta property="og:url" content="https://example.com/page.html">
    -->
    <meta property="og:title" content="203Garage｜the vintage store">
    <!--
        <meta property="og:image" content="https://example.com/image.jpg">
    -->
    <meta property="og:description" content="203Garage｜Main Page">
    <meta property="og:site_name" content="203Garage｜the vintage store">
    <meta property="og:locale" content="ko_KR">

    <link rel="icon" href="data:,">
    <link rel="stylesheet" href="./reset.css">
    <link rel="stylesheet" href="./style.css">

    <script src="./zoomDisabler.js" defer></script>
</head>
<body>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"
  integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>

    <script src="https://www.gstatic.com/firebasejs/8.6.5/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.6.5/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.6.5/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.6.5/firebase-storage.js"></script>

  <script>
    const firebaseConfig = {
        apiKey: "AIzaSyCyOKfpP4iWe6ruzCZdlFU-A1_M6-o_4ZU",
        authDomain: "garage-a3390.firebaseapp.com",
        projectId: "garage-a3390",
        storageBucket: "garage-a3390.appspot.com",
        messagingSenderId: "701651792962",
        appId: "1:701651792962:web:3db7b2ce426ebb878169db"
        };

        // initialize Firebase
      firebase.initializeApp(firebaseConfig);
  </script>

    <!--noise Background-->
    <div class="background"></div>

    <!--nav Bar-->
    <div id="nav"></div>
    <script>
      $("#nav").load("nav.html");
    </script>

    <!--protection Margin-->
    <div class="protMarginTop"></div>
    <div class="protMarginBottom"></div>

    <!--container-->
    <div class="container">
      <div class="productList"></div>
    </div>

    <script>
      const db = firebase.firestore();

      function priceToString(price) {
      return price.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
      }

      var queryStream = new URLSearchParams(window.location.search);
      var category = queryStream.get("id");
      
      if (category == null || category == "All") {
        db.collection("product")
        .orderBy("date", "desc")
        .get()
        .then((result) => {
          result.forEach((doc) => {
            console.log(doc.data());

            var template = `<div class="product" OnClick="$('.container').fadeOut(500, function() {
    window.location.href = './detail.html?id=${doc.id}';
 }); " style="display: none; cursor:pointer;" >
          <div class="thumbnail" style="background-image: url('${doc.data().image}') ;"></div>
          <div class="productIndex">
            <p class="brand">${doc.data().brand}</h5>
            <p class="category">${doc.data().category}</p>
            <p class="size">Size: ${doc.data().size}</p>
            <p class="price">${priceToString(doc.data().price)} KRW</p>
          </div>
        </div>`;

            $(".productList").append(template);
            $(".product").fadeIn(500);
          });
        });
      }
      else {
        db.collection("product").where("category", "==", category).orderBy("date", "desc")
        .get()
        .then((result) => {
          result.forEach((doc) => {
            console.log(doc.data());
            var template = `<div class="product" OnClick="$('.container').fadeOut(500, function() {
    window.location.href = './detail.html?id=${doc.id}';
 }); " style="display: none; cursor:pointer;" >
          <div class="thumbnail" style="background-image: url('${doc.data().image}') ;"></div>
          <div class="productIndex">
            <p class="brand">${doc.data().brand}</h5>
            <p class="category">${doc.data().category}</p>
            <p class="size">Size: ${doc.data().size}</p>
            <p class="price">${priceToString(doc.data().price)} KRW</p>
          </div>
        </div>`;

            $(".productList").append(template);
            $(".product").ready(function() {
              $(".product").fadeIn(500);
            })
            
          });
        });
      }
        
    </script>

</body>
</html>